<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jogo de Cartas</title>
  <style>
    html,
    body {
      overflow: hidden;
    }

    body {
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      font-family: sans-serif;
      text-align: center;
      background: #111;
      color: #fff;
      min-height: 100vh;
      width: 100vw;
    }

    #popup {
      height: 80vh;
      width: 80vw;
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: rgba(0, 119, 188, 0.4);
      border: solid 1px rgba(2, 0, 102, 0.4);
      box-shadow: 0 0 25px rgba(0, 162, 255);
      padding: 20px;
      border-radius: 10px;
      z-index: 5;
    }

    #overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 5;
    }

    #lifeBar,
    #lifeBarsContainer {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      background-color: rgba(0, 162, 255, 0.4);
      border-radius: 25px;
      padding: 10px;
      text-align: center;
      border: solid 1px rgba(2, 0, 102, 0.4);
      box-shadow: 0 0 30px rgba(0, 162, 255);
      padding: 10px;
      max-width: 200px;
      min-width: 100px;
    }

    #lifeBarsContainer {
      max-width: 800px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin-left: 300px;
    }

    #playerBarra {
      height: 40px;
      width: 100%;
      background-color: #292929;
      margin-top: -100px;
      margin-bottom: 100px;
    }

    #finalTurno {
      width: 150%;
      height: 40px;
      font-size: 100%;
      background-color: rgba(0, 255, 255, 0.521);
      border-radius: 0px 25px;
      border: solid 2px rgba(0, 255, 255, 0.521);
      color: aliceblue;
      padding: 10px;
      transition: 0.5s;
    }

    #finalTurno:hover {
      background-color: rgb(0, 214, 53);
      box-shadow: 2px 2px 50px 2px rgba(0, 255, 106, 0.521);
      width: 160%;
      border: solid 2px rgba(5, 129, 57, 0.644);
    }

    #jogo {
      margin-top: 20px;
      width: 100%;
      max-width: 100vw;
      min-height: 77vh;
      background-image: url(./img/background/luta3.png);
      background-size: cover;
      background-position: top;
      background-repeat: no-repeat;
      background-position-y: -660px;
      padding-top: 10px;
      padding-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: end;
      flex-direction: column;
    }

    #battlefield {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      gap: 500px;
      margin-bottom: -25px;
    }

    #player-area,
    .enemy {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #enemies {
      gap: 50px;
      margin-left: 320px;
    }

    #player,
    .enemy img {
      width: 200px;
      transition: filter 0.4s ease;
    }

    .enemy {
      margin-bottom: -30px;
    }


    #player {
      width: 250px;
    }

    #hud {
      margin: 15px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      flex-direction: column;
    }

    #cards {
      min-height: 235px;
      width: 100%;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin: 10px 0;
      margin-bottom: -100px;
      background-color: #292929;
      padding-top: 20px;
      padding-bottom: 30px;
    }

    .desc {
      margin-top: 10px;
      text-align: center;
      width: 85%;
    }

    .energia {
      color: rgb(0, 0, 0);
      width: 76%;
      margin-top: -100px;
      margin-bottom: 72px;
      text-align: left;
      border-radius: 100%;
    }

    .card {
      width: 155px;
      height: 227px;
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: transform 0.2s, opacity 0.3s;
      overflow: hidden;
    }

    .card img {
      width: 55%;
      height: auto;
      object-fit: cover;
      border-bottom: 1px solid #292929;
      border-radius: 100%;
      margin-top: 25px;
      border: solid 2px rgb(32, 32, 32);
      box-shadow: 0 0 10px #292929;
    }

    .card .desc {
      font-size: 14px;
      padding: 6px;
    }

    .card:hover {
      transform: scale(1.10);
    }

    .card-remove {
      animation: fadeOut 0.3s ease forwards;
    }

    @keyframes fadeOut {
      to {
        opacity: 0;
        transform: scale(0.5);
      }
    }

    .attack {
      background-image: url("img/cards/vermelho.jpg");
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
    }

    .defense {
      background-image: url("img/cards/azul.jpg");
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
    }

    .heal {
      background-image: url("img/cards/verd.jpg");
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
    }

    .reciclagem {
      background-image: url("img/cards/amarelo.jpg");
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
    }

    .lixo {
      background-image: url("img/cards/sinza.jpg");
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
    }

    .cintilante {
      background-image: url("img/cards/cintilante.png");
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
    }

    .common {
      box-shadow: 0 0 20px rgb(168, 168, 168);
      border: solid 3px rgb(119, 119, 119);
    }

    .common img {
      border: solid 3px rgb(119, 119, 119);
    }

    .rare {
      box-shadow: 0 0 20px rgb(0, 110, 255);
      border: solid 3px rgb(0, 84, 194);
    }

    .rare img {
      border: solid 3px rgb(0, 84, 194);
    }

    .epic {
      box-shadow: 0 0 20px rgb(140, 0, 255);
      border: solid 3px rgb(92, 0, 167);
    }

    .epic img {
      border: solid 3px rgb(92, 0, 167);
    }

    .legend {
      box-shadow: 0 0 20px rgb(255, 230, 0);
      border: solid 3px rgb(167, 142, 0);
    }

    .legend img {
      border: solid 3px rgb(167, 142, 0);
    }

    .cintilante {
      box-shadow: 0 0 30px rgb(208, 0, 255);
      border: 3px solid rgb(243, 186, 255);
    }

    .cintilante img {
      border: 3px solid rgb(243, 186, 255);
    }

    /* cria a borda com gradiente */
    .cintilante::before img {
      content: "";
      position: absolute;
      top: -3px;
      left: -3px;
      right: -3px;
      bottom: -3px;
      border-radius: 14px;
      background: conic-gradient(red, orange, yellow, lime, cyan, blue, violet, red);
      z-index: -1;
      animation: spin 7.5s linear infinite;
    }

    /* efeito de giro do arco-√≠ris */
    .card.cintilante {
      position: relative;
      overflow: hidden;
    }

    .card.cintilante::before {
      margin-top: -20px;
      margin-left: -60px;
      width: 300px;
      height: 300px;
      content: "";
      position: absolute;
      inset: -10px;
      border-radius: 100%;
      background: conic-gradient(rgba(255, 255, 255, 0.3),
          rgba(238, 130, 238, 0.3),
          rgba(0, 255, 255, 0.3),
          rgba(0, 255, 0, 0.3),
          rgba(255, 255, 0, 0.3),
          rgba(255, 166, 0, 0.3),
          rgba(255, 0, 0, 0.3),
          rgba(255, 255, 255, 0.3));
      z-index: -1;
      animation: spin 17.5s linear infinite;

      /* inicia invis√≠vel */
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    /* Ao passar o mouse na card, o ::before aparece */
    .card.cintilante:hover::before {
      opacity: 1;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    #log {
      width: 140px;
      margin-top: 5px;
      height: 80px;
      overflow-y: auto;
      font-size: 14px;
      background-color: rgba(0, 162, 255, 0.4);
      text-align: center;
      padding: 10px;
      border-radius: 10px;
      border: solid 1px rgba(2, 0, 102, 0.4);
      color: rgba(2, 0, 102);
      box-shadow: 0 0 30px rgba(0, 162, 255);
    }

    @keyframes glow-blue {

      0%,
      100% {
        box-shadow: 0 0 0px rgb(79, 158, 255);
        border-radius: 0 0 100% 100%;
      }

      50% {
        box-shadow: 0 0 65px rgb(79, 158, 255);
        border-radius: 0 0 100% 100%;
        /* transform: rotate(360deg); */
      }
    }

    @keyframes glow-green {

      0%,
      100% {
        box-shadow: 0 0 0px rgb(112, 231, 112);
        background-color: rgba(112, 231, 112, 0.1);
        border-radius: 100%;
      }

      50% {
        box-shadow: 0 0 65px rgb(112, 231, 112);
        background-color: rgba(112, 231, 112, 0.35);
        border-radius: 100%;
      }
    }

    .healed {
      animation: glow-green 0.8s ease-out;
    }

    @keyframes glow-cintilante {

      0%,
      100% {
        box-shadow: 0 0 0px rgb(205, 112, 231);
        background-color: rgba(217, 112, 231, 0.1);
        border-radius: 100%;
      }

      50% {
        box-shadow: 0 0 65px rgb(255, 255, 255);
        background-color: rgba(255, 255, 255, 0.35);
        border-radius: 100%;
      }
    }

    .glow-blue {
      animation: glow-blue 1s ease;
    }

    .glow-green {
      animation: glow-green 1s ease;
    }

    .glow-cintilante {
      animation: glow-cintilante 1s ease;
    }

    @keyframes shake {

      0%,
      100% {
        transform: translateX(0);
      }

      25% {
        transform: translateX(-5px);
      }

      75% {
        transform: translateX(5px);
      }
    }

    .shake {
      animation: shake 0.3s;
    }

    .damaged {
      filter: brightness(1.5) sepia(1) hue-rotate(-30deg);
    }

    .float-text {
      position: absolute;
      font-weight: bold;
      color: white;
      text-shadow: 1px 1px 3px black;
      pointer-events: none;
      z-index: 9999;
      font-size: 40px;
    }

    @keyframes floatUp {
      0% {
        transform: translateY(0);
        opacity: 1;
      }

      100% {
        transform: translateY(-50px);
        opacity: 0;
      }
    }
  </style>
</head>

<body>
  <div id="overlay"></div>
  <div id="popup">
    <p>Escolha sua recompensa!</p>
    <div id="recompensa"></div>
    <button onclick="fecharPopup()">Escolher</button>
  </div>

  <header id="playerBarra"></header>
  <div id="jogo">
    <div id="log"></div>
    <div id="battlefield">
      <div id="player-area">
        <p id="lifeBar">‚ù§Ô∏è <strong><span id="hp"></span></strong> üî∑ <strong><span id="energy">3</span></strong></p>
        <img id="player" src="./img/player/mineiro.png" alt="Jogador">
      </div>
      <div id="inimigo-area">
        <div id="lifeBarsContainer"></div>
        <div id="enemies"></div>
      </div>
    </div>

    <div id="hud">
      <button onclick="enemyTurn()" id="finalTurno">FINALIZAR TURNO</button>
    </div>

    <div id="cards"></div>
  </div>

  <script>
    let playerHP = 100, energy = 3, playerShield = 0;
    let playerMaxHP = 100;
    const deck = [];
    const allCards = [
      {
        name: "G√ÜPROTOCOL",
        cost: 3,
        basePower: 20,
        rarity: "cintilante",
        img: "./img/cards/cintilante/gaea.png",
        desc: "Recicla lixo. Ganhe vida, defesa e cause dano em 20 por cada carta de lixo reciclada.",
      },
      {
        name: "Impacto Bruto",
        cost: 3,
        basePower: 25,
        rarity: "epic",
        img: "./img/cards/atk/Impacto.png",
        desc: "Causa 25 de dano ao inimigo."
      },
      {
        name: "Ataque",
        cost: 1,
        basePower: 6,
        rarity: "common",
        img: "./img/cards/atk/LancaGranadas.png",
        desc: "Causa 6 de dano ao inimigo."
      },
      {
        name: "Drenagem",
        cost: 1,
        basePower: 10,
        rarity: "legend",
        img: "./img/cards/atk/drenoDeVida.png",
        desc: "Causa 10 de dano ao inimigo e cure-se em 10."
      },
      {
        name: "Rajada Dupla",
        cost: 1,
        basePower: 6,
        rarity: "rare",
        img: "./img/cards/atk/tiroCarregado.png",
        desc: "Ataca 2 vezes com 6 de dano cada."
      },
      {
        name: "Explos√£o",
        cost: 1,
        basePower: 6,
        rarity: "common",
        img: "./img/cards/atk/ExplosaoDeEnergia.png",
        desc: "Causa 6 de dano em √°rea a todos os inimigos."
      },
      {
        name: "Chuva De Fragmentos",
        cost: 2,
        basePower: 12,
        rarity: "rare",
        img: "./img/cards/atk/ChuvaDeFragmento.png",
        desc: "Causa 12 de dano em √°rea a todos os inimigos."
      },
      {
        name: "Beserck",
        cost: 2,
        basePower: 10,
        rarity: "epic",
        img: "./img/cards/atk/beserck.png",
        desc: "Perca 10 de vida e toda sua armadura, cause dano baseado na armadura perdida +10."
      },
      {
        name: "Fogo Amigo",
        cost: 3,
        basePower: 30,
        rarity: "epic",
        img: "./img/cards/atk/bombardeio.png",
        desc: "Cause 30 de dano em area, a cada inimigo no campo receba 15 de dano (max 45)."
      },
      {
        name: "Defesa",
        cost: 0,
        basePower: 4,
        rarity: "common",
        img: "./img/cards/def/Blindagem.png",
        desc: "Ganha 4 de escudo."
      },
      {
        name: "PROTOCOL-Campo De For√ßa",
        cost: 1,
        basePower: 40,
        rarity: "epic",
        img: "./img/cards/def/campoDeForca.png",
        desc: "Se sua vida for 25 ou menos ganhe 40 de escudo"
      },
      {
        name: "Brilhando",
        cost: 2,
        basePower: 60,
        rarity: "legend",
        img: "./img/cards/def/escudoDeVidro.png",
        desc: "Se sua vida estiver cheia ganhe 60 de escudo"
      },
      {
        name: "Impulso Defensivo",
        cost: 0,
        basePower: 1,
        rarity: "rare",
        img: "./img/cards/def/impulsoAzul.png",
        desc: "Ganha 3 de escudo e receba 1 de energia"
      },
      {
        name: "Escudo",
        cost: 1,
        basePower: 8,
        rarity: "common",
        img: "./img/cards/def/escudoHolo.png",
        desc: "Cria um escudo de 8 pontos."
      },
      {
        name: "Sistema de reflex√£o",
        cost: 2,
        basePower: 5,
        rarity: "epic",
        img: "./img/cards/def/sisReflexao.png",
        desc: "Cria um escudo de 10 pontos e cause 5 de dano."
      },
      {
        name: "Escudo Retaliante",
        cost: 1,
        basePower: 0,
        rarity: "rare",
        img: "./img/cards/def/escudoRetaliante.png",
        desc: "Causa dano igual √† sua armadura atual."
      },
      {
        name: "Cura",
        cost: 1,
        basePower: 6,
        rarity: "common",
        img: "./img/cards/buff/Cura.png",
        desc: "Recupera 6 de vida."
      },
      {
        name: "Minera√ß√£o",
        cost: 0,
        basePower: 3,
        rarity: "legend",
        img: "./img/cards/buff/mineracao.png",
        desc: "Miner√ß√£o sustentavel, fornesce 3 de energia, viva a sustentabilidade!"
      },
      {
        name: "PROTOCOL-Refor√ßo Estrutural",
        cost: 1,
        basePower: 20,
        rarity: "epic",
        img: "./img/cards/buff/reforcoDeEstrutura.png",
        desc: "Cure 20 de vida se sua vida estiver em 25 ou menos."
      },
      {
        name: "Impulso",
        cost: 1,
        basePower: 1,
        rarity: "epic",
        img: "./img/cards/buff/impulsoVerd.png",
        desc: "Aumenta a m√£o em 1 at√© o final da luta (limite da m√£o 10)"
      },
      {
        name: "Golpe Neural Retaliante",
        cost: 3,
        basePower: playerHP,
        rarity: "epic",
        img: "./img/cards/buff/neural.png",
        desc: "Cause dano igual sua vida atual, perca 25 da vida atual"
      },
      {
        name: "Sobre Carga",
        cost: 1,
        basePower: 6,
        rarity: "rare",
        img: "./img/cards/buff/sobreCarga.png",
        desc: "Perca 6 de vida e cause 12 de dano."
      },
      {
        name: "Compra Dupla",
        cost: 1,
        basePower: 0,
        rarity: "rare",
        img: "./img/cards/buff/comprarCarta.png",
        desc: "Compra 2 cartas aleat√≥rias."
      },
      {
        name: "Recicladora",
        cost: 1,
        basePower: 15,
        rarity: "legend",
        img: "./img/cards/reciclagem/reciclagem.png",
        desc: "Se a vida do inimigo for exatamente 15, elimine ele, caso contrario ganhe 15 de escudo."
      },
      {
        name: "Destruir Carta",
        cost: 0,
        basePower: 0,
        rarity: "common",
        img: "./img/cards/reciclagem/destruirCarta.png",
        desc: "Destroi todas as cartas do tipo 'lixo' na sua m√£o.",
      },
      {
        name: "Ataque Recicl√°vel",
        cost: 1,
        basePower: 0,
        rarity: "rare",
        img: "./img/cards/reciclagem/atkReciclavel.png",
        desc: "Remove cartas de lixo da m√£o e causa 5 de dano por cada carta removida.",
        type: "attack"
      },
      {
        name: "Defesa Recicl√°vel",
        cost: 1,
        basePower: 0,
        rarity: "rare",
        img: "./img/cards/reciclagem/defesaReciclavel.png",
        desc: "Remove cartas de lixo da m√£o e ganhe 5 de escudo por cada carta removida.",
        type: "attack"
      },
      {
        name: "Xenofluxo Recicl√°vel",
        cost: 0,
        basePower: 0,
        rarity: "rare",
        img: "./img/cards/reciclagem/ganhoDeEnergia.png",
        desc: "Remove cartas de lixo da m√£o e ganhe 1 de energia por cada carta removida.",
        type: "attack"
      },
      {
        name: "Entulho",
        cost: 0,
        basePower: 0,
        rarity: "common",
        img: "./img/cards/lixo/entulho.png",
        desc: "Um monte de entulho que n√£o faz nada, quem sabe voc√™ ache uma utilidade para ele.",
        type: "lixo"
      },
      {
        name: "Escudo quebrado",
        cost: 0,
        basePower: 0,
        rarity: "common",
        img: "./img/cards/lixo/escudoQuebrado.png",
        desc: "Ganhe 0 de defesa.",
        type: "lixo"
      },
      {
        name: "Arma Quebrada",
        cost: 0,
        basePower: 0,
        rarity: "common",
        img: "./img/cards/lixo/armaQuebrada.png",
        desc: "Cause 0 de dano.",
        type: "lixo"
      },
      {
        name: "Restos de meca",
        cost: 0,
        basePower: 0,
        rarity: "common",
        img: "./img/cards/lixo/mecaLixo.png",
        desc: "Adiciona 5 cartas de Entulho √† sua m√£o.",
        type: "lixo"
      },
      {
        name: "Chamado do Alfa",
        cost: 0,
        basePower: 0,
        rarity: "rare",
        img: "./img/cards/lixo/alfa.png",
        desc: "Adiciona 2 cartas de Alcateia √† sua m√£o.",
        type: "lixo"
      },
      {
        name: "Alcateia",
        cost: 0,
        basePower: 0,
        rarity: "common",
        img: "./img/cards/lixo/alcateia.png",
        desc: "Adiciona 2 cartas de Lobo √† sua m√£o.",
        type: "lixo"
      },
      {
        name: "Lobo",
        cost: 0,
        basePower: 0,
        rarity: "common",
        img: "./img/cards/lixo/lobo.png",
        desc: "Cause 2 de dano a voc√™.",
        type: "lixo"
      },
      {
        name: "Ferro Velho",
        cost: 0,
        basePower: 0,
        rarity: "common",
        img: "./img/cards/lixo/ferroVelho.png",
        desc: "Adiciona 2 cartas de Entulho √† sua m√£o.",
        type: "lixo"
      }
    ];

    const enemyModels = [
      {
        name: "Tartaruga",
        hp: 54,
        dano: 6,
        behavior: () => [{ type: "attack", value: 6 }],
        img: "./img/inimigos/minion.png",
        tipoDano: "‚öîÔ∏è"
      },
      {
        name: "Tatu corrompido",
        hp: 60,
        dano: 8,
        behavior: () => [{ type: "attack", value: 8 }],
        img: "./img/inimigos/tatu.png",
        tipoDano: "‚öîÔ∏è"
      },
      {
        name: "Furungrolumelo",
        hp: 10,
        dano: 24,
        behavior: () => [{ type: "attack", value: 24 }],
        img: "./img/inimigos/inimigo2.png",
        tipoDano: "‚öîÔ∏è"
      },
      {
        name: "Abelha corrompida",
        hp: 6,
        dano: 6,
        behavior: () => [{ type: "attack", value: 6 }],
        img: "./img/inimigos/abelha.png",
        tipoDano: "‚öîÔ∏è"
      },
      {
        name: "Ferruj√£o",
        hp: 40,
        dano: 12,
        behavior: () => [{ type: "attack", value: 12 }],
        img: "./img/inimigos/inimigo1.png",
        tipoDano: "‚öîÔ∏è"
      },
      {
        name: "Drone agricola",
        hp: 8,
        dano: 6,
        behavior: () => [{ type: "attackVida", value: 6 }],
        img: "./img/inimigos/inimigo5.png",
        tipoDano: "üíÄ"
      },
      {
        name: "Boss Valquiria",
        hp: 150,
        dano: 20,
        behavior: () => [
          { type: "attack", value: Math.random() < 0.5 ? 20 : 40 }
        ],
        img: "./img/inimigos/bossValquiria.png",
        tipoDano: "‚öîÔ∏è‚ú®"
      },
      {
        name: "Valquiria",
        hp: 40,
        dano: 7,
        behavior: () => [{ type: "attackVida", value: 7 }],
        img: "./img/inimigos/valquiria.png",
        tipoDano: "üíÄ"
      },
      {
        name: "IA sacerdotisa",
        hp: 24,
        dano: 2,
        behavior: () => [{ type: "heal", value: Math.random() < 0.5 ? 2 : 4 }],
        img: "./img/inimigos/sacerdotisa.png",
        tipoDano: "üíö‚ú®"
      },
      {
        name: "Boss Alfa",
        hp: 100,
        dano: 10,
        behavior: () => [{ type: "attackVida", value: 10 }],
        img: "./img/inimigos/bossLobo.png",
        tipoDano: "üíÄ"
      },
      {
        name: "Lobo",
        hp: 20,
        dano: 5,
        behavior: () => [
          { type: "attack", value: Math.random() < 0.5 ? 5 : 10 }
        ],
        img: "./img/inimigos/lobo.png",
        tipoDano: "‚öîÔ∏è‚ú®"
      }
    ];

    function createEnemy(imgSrc) {
      const div = document.createElement("div");
      div.className = "enemy";
      div.innerHTML = `<img src="${imgSrc}" alt="Inimigo">`;
      document.getElementById("enemies").appendChild(div);
      return div;
    }

    let enemies = [];

    function spawnEnemies() {
      enemies = [];
      const enemiesContainer = document.getElementById("enemies");
      enemiesContainer.innerHTML = ""; // limpa inimigos
      document.getElementById("lifeBarsContainer").innerHTML = ""; // limpa barras de status

      const qtd = Math.floor(Math.random() * 3) + 1; // 1 a 3 inimigos

      for (let i = 0; i < qtd; i++) {
        const base = enemyModels[Math.floor(Math.random() * enemyModels.length)];

        // cria inimigo
        const enemy = {
          name: base.name,
          hp: base.hp,
          maxHp: base.hp,
          dano: base.dano,
          behavior: base.behavior,
          el: createEnemy(base.img),
          tipoDano: base.tipoDano
        };
        enemies.push(enemy);

        // cria barra de status individual
        const lifeBar = document.createElement("p");
        lifeBar.className = "enemy-bar";
        lifeBar.innerHTML = `| ‚ù§Ô∏è <strong>${enemy.name}: <span class="enemy-hp">${enemy.hp}</span> </strong> ${enemy.tipoDano} <strong>${enemy.dano} | </strong>`;
        document.getElementById("lifeBarsContainer").appendChild(lifeBar);

        // linka a barra ao inimigo
        enemy.barEl = lifeBar.querySelector(".enemy-hp");
      }

      enemiesContainer.style.display = "flex";
    }

    function updateHUD() {
      document.getElementById("hp").textContent = `${playerHP} | üõ°Ô∏è ${playerShield} | `;
      document.getElementById("energy").textContent = energy;

      enemies.forEach(e => {
        if (e.barEl) e.barEl.textContent = e.hp > 0 ? e.hp : 0;
      });
    }

    let floatQueue = [];
    let showingFloat = false;

    function floatText(target, text, color) {
      // Adiciona √† fila
      floatQueue.push({ target, text, color });

      // Se j√° estiver mostrando, n√£o dispara outra
      if (!showingFloat) processFloatQueue();
    }

    function processFloatQueue() {
      if (floatQueue.length === 0) {
        showingFloat = false;
        return;
      }

      showingFloat = true;
      const { target, text, color } = floatQueue.shift();

      const div = document.createElement("div");
      div.className = "float-text";
      div.style.color = color;
      div.style.fontWeight = "bold";
      div.style.position = "absolute";
      div.style.opacity = "1";
      div.style.pointerEvents = "none"; // Para n√£o bloquear cliques
      div.innerText = text;
      document.body.appendChild(div);

      // üîπ Posi√ß√£o inicial
      let x = window.innerWidth / 2;
      let y = window.innerHeight / 2;

      if (target && target.getBoundingClientRect) {
        const rect = target.getBoundingClientRect();
        x = rect.left + rect.width / 2 + window.scrollX;
        y = rect.top + window.scrollY - 20; // sobe um pouco acima do alvo
      }

      div.style.left = x + "px";
      div.style.top = y + "px";
      div.style.transform = "translateX(-50%)";

      // üîπ Anima√ß√£o (subir e desaparecer)
      setTimeout(() => {
        div.style.transition = "all 0.8s ease-out";
        div.style.opacity = "0";
        div.style.top = (y - 40) + "px";
      }, 50);

      // üîπ Remover e processar pr√≥ximo
      setTimeout(() => {
        div.remove();
        processFloatQueue();
      }, 900);
    }

    function glowPlayer(color) {
      const p = document.getElementById("player");
      p.classList.remove("glow-blue", "glow-green");
      if (color === "blue") p.classList.add("glow-blue");
      if (color === "green") p.classList.add("glow-green");
      if (color === "cintilante") p.classList.add("glow-cintilante");
      setTimeout(() => p.classList.remove("glow-blue", "glow-green", "glow-cintilante"), 1000);
    }

    function animateDamage(el) {
      el.classList.add("shake", "damaged");
      setTimeout(() => el.classList.remove("shake", "damaged"), 400);
    }



    function drawCards() {
      const cards = document.getElementById("cards");
      cards.innerHTML = "";
      deck.forEach((card, i) => {
        const div = document.createElement("div");
        let tipo = card.name === "Ataque" || card.name === "Impacto Bruto" || card.name === "Fogo Amigo" || card.name === "Drenagem" || card.name === "Beserck" || card.name === "Explos√£o" || card.name === "Chuva De Fragmentos" || card.name === "Rajada Dupla" ? "attack" : card.name === "Recicladora" || card.name === "Ataque Recicl√°vel" || card.name === "Defesa Recicl√°vel" || card.name === "Xenofluxo Recicl√°vel" || card.name === "Destruir Carta" ? "reciclagem" : card.name === "Entulho" || card.name === "Lobo" || card.name === "Alcateia" || card.name === "Chamado do Alfa" || card.name === "Arma Quebrada" || card.name === "Escudo quebrado" || card.name === "Restos de meca" || card.name === "Ferro Velho" ? "lixo" :
          card.name === "Defesa" || card.name === "Sistema de reflex√£o" || card.name === "Escudo Retaliante" || card.name === "Impulso Defensivo" || card.name === "PROTOCOL-Campo De For√ßa" || card.name === "Brilhando" || card.name === "Escudo" ? "defense" : card.name === "G√ÜPROTOCOL" ? "cintilante" :
            card.name === "Cura" || card.name === "Minera√ß√£o" || card.name === "PROTOCOL-Refor√ßo Estrutural" || card.name === "Impulso" || card.name === "Golpe Neural Retaliante" || card.name === "Compra Dupla" || card.name === "Sobre Carga" ? "heal" : "";
        div.className = `card ${card.rarity} ${tipo}`;
        div.innerHTML = `
          <img src="${card.img}" alt="${card.name}">
          <div class="energia"><strong>${card.cost}</strong></div>
          <div class="desc"><strong>${card.name}</strong><br><em>${card.desc}</em></div>
        `;
        div.onclick = () => {
          if (energy < card.cost || playerHP <= 0 || enemies.length === 0) return;
          energy -= card.cost;

          if (card.name === "Ataque") {
            animateDamage(enemies[0].el);
            enemies[0].hp -= card.power;
            floatText(enemies[0].el, `-${card.power}`, "red");
            log("Usou Ataque!");
          } else if (card.name === "Defesa") {
            playerShield += card.power;
            glowPlayer("blue");
            floatText(document.getElementById("player"), `+${card.power}`, "cyan");
            log("Usou Defesa!");
          } else if (card.name === "Drenagem") {
            playerShield += card.power;
            glowPlayer("green");
            playerHP = Math.min(playerHP + card.power, playerMaxHP);
            enemies[0].hp -= card.power;
            floatText(enemies[0].el, `-${card.power}`, "red");
            floatText(document.getElementById("player"), `+${card.power}`, "lime");
            log("Usou Drenagem!");
          } else if (card.name === "Cura") {
            playerHP = Math.min(playerHP + card.power, playerMaxHP);
            glowPlayer("green");
            floatText(document.getElementById("player"), `+${card.power}`, "lime");
            log("Usou Cura!");
          } else if (card.name === "Explos√£o") {
            enemies.forEach(e => {
              animateDamage(e.el);
              e.hp -= card.power;
              floatText(e.el, `-${card.power}`, "red");
            });
            log("Usou Explos√£o!");
          } else if (card.name === "Chuva De Fragmentos") {
            enemies.forEach(e => {
              animateDamage(e.el);
              e.hp -= card.power;
              floatText(e.el, `-${card.power}`, "red");
            });
            log("Usou Chuva De Fragmentos!");
          } else if (card.name === "Fogo Amigo") {
            enemies.forEach(e => {
              animateDamage(e.el);
              e.hp -= card.power;
              floatText(e.el, `-${card.power}`, "red");
              let dano = 15;

              if (playerShield > 0) {
                let absorbed = Math.min(dano, playerShield);
                playerShield -= absorbed;
                dano -= absorbed;
              }
              if (dano > 0) {
                playerHP -= dano;
              }
            });
            animateDamage(document.getElementById("player"));
            log("Usou Fogo Amigo!");
          } else if (card.name === "Escudo") {
            playerShield += card.power;
            glowPlayer("blue");
            floatText(document.getElementById("player"), `+${card.power}`, "cyan");
            log("Usou Escudo!");
          } else if (card.name === "Rajada Dupla") {
            animateDamage(enemies[0].el);
            enemies[0].hp -= card.power;
            enemies[0].hp -= card.power;
            floatText(enemies[0].el, `-${card.power}`, "red");
            floatText(enemies[0].el, `-${card.power}`, "red");
            log("Usou Rajada Dupla!");
          } else if (card.name === "Impacto Bruto") {
            animateDamage(enemies[0].el);
            enemies[0].hp -= card.power;
            floatText(enemies[0].el, `-${card.power}`, "red");
            log("Usou Impacto Bruto!");
          } else if (card.name === "Sobre Carga") {
            animateDamage(enemies[0].el);
            animateDamage(document.getElementById("player"));
            playerHP = Math.min(playerHP - card.power, playerMaxHP);
            enemies[0].hp -= card.power * 2;
            floatText(enemies[0].el, `-${card.power * 2}`, "red");
            log("Usou Sobre Carga!");
            floatText(document.getElementById("player"), `-${card.power}`, "red");
          } else if (card.name === "Sistema de reflex√£o") {
            animateDamage(enemies[0].el);
            glowPlayer("blue");
            playerShield += (card.power * 2);
            enemies[0].hp -= card.power;
            floatText(enemies[0].el, `-${card.power}`, "red");
            log("Usou Sistema de reflex√£o!");
            floatText(document.getElementById("player"), `+${(card.power * 2)}`, "cyan");
          } else if (card.name === "Golpe Neural Retaliante") {
            animateDamage(enemies[0].el);
            animateDamage(document.getElementById("player"));
            enemies[0].hp -= playerHP;
            floatText(enemies[0].el, `-${playerHP}`, "red");
            playerHP -= 25;
            log("Usou Golpe Neural Retaliante!");
            floatText(document.getElementById("player"), `${"-25"}`, "red");
          } else if (card.name === "Beserck") {
            if (playerShield > 0) {
              enemies[0].hp -= playerShield;
              floatText(document.getElementById("player"), `-${playerShield}`, "red");
              playerShield = 0;
              animateDamage(enemies[0].el);
            }
            animateDamage(enemies[0].el);
            animateDamage(document.getElementById("player"));
            enemies[0].hp -= card.power;
            playerHP -= card.power;
            floatText(enemies[0].el, `-${card.power}`, "red");
            log("Beserck!");
            floatText(document.getElementById("player"), `-${card.power}`, "red");
          } else if (card.name === "Impulso") {
            if (limiteMao < 10) {
              limiteMao += 1;
            }
            glowPlayer("green");
            floatText(document.getElementById("player"), `+${card.power}`, "lime");
            log("Usou Impulso!");
          } else if (card.name === "Minera√ß√£o") {
            energy += card.power;
            glowPlayer("green");
            floatText(document.getElementById("player"), `+${card.power}`, "lime");
            log("Usou Impulso!");
          } else if (card.name === "PROTOCOL-Refor√ßo Estrutural") {
            if (playerHP <= 25) {
              playerHP = Math.min(playerHP + card.power, playerMaxHP);
              floatText(document.getElementById("player"), `+${card.power}`, "lime");
              glowPlayer("green");
            }
            log("Usou PROTOCOL-Refor√ßo De For√ßa!");
          } else if (card.name === "PROTOCOL-Campo De For√ßa") {
            if (playerHP <= 25) {
              playerShield += card.power;
              floatText(document.getElementById("player"), `+${card.power}`, "cyan");
              glowPlayer("blue");
            }
            log("Usou PROTOCOL-Campo De For√ßa!");
          } else if (card.name === "Brilhando") {
            if (playerHP == playerMaxHP) {
              playerShield += card.power;
              floatText(document.getElementById("player"), `+${card.power}`, "cyan");
              glowPlayer("blue");
            }
            log("Usou Brilhando!");
          } else if (card.name === "Impulso Defensivo") {
            energy += card.power;
            playerShield += card.power * 3;
            glowPlayer("blue");
            floatText(document.getElementById("player"), `+${card.power}`, "cyan");
            floatText(document.getElementById("player"), `+${card.power + 2}`, "cyan");
            log("Usou Impulso Defensivo!");
          } else if (card.name === "Recicladora") {
            if (enemies[0].hp == 15) {
              animateDamage(enemies[0].el);
              enemies[0].hp -= enemies[0].hp;
              floatText(enemies[0].el, `-${card.power}`, "red");
            } else {
              playerShield += card.power;
              floatText(document.getElementById("player"), `+${card.power}`, "cyan");
              glowPlayer("blue");
            }
            log("Usou Recicladora!");
          } else if (card.name === "Entulho") {
            log("Usou Entulho!");
          } else if (card.name === "Escudo quebrado") {
            floatText(document.getElementById("player"), `+${"0"}`, "cyan");
            log("Usou Escudo quebrado!");
          } else if (card.name === "Arma Quebrada") {
            floatText(enemies[0].el, `-${"0"}`, "red");
            log("Usou Arma Quebrada!");
          } else if (card.name === "Compra Dupla") {
            for (let i = 0; i < 2; i++) {
              const newCard = {
                ...allCards[Math.floor(Math.random() * allCards.length)],
                power: allCards[Math.floor(Math.random() * allCards.length)].basePower
              };
              deck.push(newCard); // adiciona diretamente, ignorando limite
            }
            log("Usou Compra Dupla!");
            glowPlayer("green");
          } else if (card.name === "Escudo Retaliante") {
            animateDamage(enemies[0].el);
            enemies[0].hp -= playerShield;
            floatText(enemies[0].el, `-${playerShield}`, "red");
            log("Usou Escudo Retaliante!");
            glowPlayer("blue");
          } else if (card.name === "Restos de meca") {
            if (energy < card.cost) return;
            energy -= card.cost;
            // Adiciona 2 cartas de Entulho na m√£o
            for (let i = 0; i < 5; i++) {
              deck.push({ ...allCards.find(c => c.name === "Entulho"), power: 0 });
            }
            log("Usou Restos de meca! 4 cartas de Entulho adicionadas.");
          } else if (card.name === "Ferro Velho") {
            if (energy < card.cost) return;
            energy -= card.cost;
            // Adiciona 2 cartas de Entulho na m√£o
            for (let i = 0; i < 2; i++) {
              deck.push({ ...allCards.find(c => c.name === "Entulho"), power: 0 });
            }
            log("Usou Ferro Velho! 2 cartas de Entulho adicionadas.");
          } else if (card.name === "Chamado do Alfa") {
            if (energy < card.cost) return;
            energy -= card.cost;
            for (let i = 0; i < 2; i++) {
              deck.push({ ...allCards.find(c => c.name === "Alcateia"), power: 0 });
            }
            log("Usou Chamado do Alfa! 2 cartas de Alcateia adicionadas.");
          } else if (card.name === "Alcateia") {
            if (energy < card.cost) return;
            energy -= card.cost;
            for (let i = 0; i < 2; i++) {
              deck.push({ ...allCards.find(c => c.name === "Lobo"), power: 0 });
            }
            log("Usou Alcateia! 2 cartas de Lobo adicionadas.");
          } else if (card.name === "Lobo") {
            animateDamage(document.getElementById("player"));
            playerHP -= 2;
            log("Carta Lobo atacou voc√™!");
            floatText(document.getElementById("player"), `${"-2"}`, "red");
          } else if (card.name === "Destruir Carta") {
            const toRemove = new Set();
            toRemove.add(card); // tamb√©m remover a pr√≥pria carta usada
            let lixoRemovido = 0;

            for (let j = 0; j < deck.length; j++) {
              const c = deck[j];
              if (c !== card && c.type === "lixo") {
                toRemove.add(c);
                lixoRemovido++;
              }
            }

            if (lixoRemovido === 0) {
              log("Nenhuma carta de lixo na m√£o para reciclar.");
              // anima s√≥ a carta usada e remova-a normalmente
              div.classList.add("card-remove");
              setTimeout(() => {
                for (let k = deck.length - 1; k >= 0; k--) {
                  if (deck[k] === card) { deck.splice(k, 1); break; }
                }
                drawCards();
                updateHUD();
              }, 300);
              return;
            }


            updateHUD();

            // anima e depois remove todas as cartas marcadas
            div.classList.add("card-remove");
            setTimeout(() => {
              for (let k = deck.length - 1; k >= 0; k--) {
                if (toRemove.has(deck[k])) deck.splice(k, 1);
              }
              drawCards();
              checkEnemies();
              updateHUD();
            }, 300);

            return;
          } else if (card.name === "Ataque Recicl√°vel") {
            // marca as cartas a remover (por identidade)
            const toRemove = new Set();
            toRemove.add(card); // tamb√©m remover a pr√≥pria carta usada
            let lixoRemovido = 0;

            for (let j = 0; j < deck.length; j++) {
              const c = deck[j];
              if (c !== card && c.type === "lixo") {
                toRemove.add(c);
                lixoRemovido++;
              }
            }

            if (lixoRemovido === 0) {
              log("Nenhuma carta de lixo na m√£o para reciclar.");
              // anima s√≥ a carta usada e remova-a normalmente
              div.classList.add("card-remove");
              setTimeout(() => {
                for (let k = deck.length - 1; k >= 0; k--) {
                  if (deck[k] === card) { deck.splice(k, 1); break; }
                }
                drawCards();
                updateHUD();
              }, 300);
              return;
            }

            // aplica efeito imediatamente
            const dano = lixoRemovido * 5;
            if (enemies.length > 0) {
              enemies[0].hp -= dano;
              animateDamage(enemies[0].el);
              floatText(enemies[0].el, `-${dano}`, "red");
            }
            updateHUD();

            // anima e depois remove todas as cartas marcadas
            div.classList.add("card-remove");
            setTimeout(() => {
              for (let k = deck.length - 1; k >= 0; k--) {
                if (toRemove.has(deck[k])) deck.splice(k, 1);
              }
              drawCards();
              checkEnemies();
              updateHUD();
            }, 300);

            return; // importante: impede que o handler padr√£o remova outra carta
          } else if (card.name === "Defesa Recicl√°vel") {
            const toRemove = new Set();
            toRemove.add(card);
            let lixoRemovido = 0;

            for (let j = 0; j < deck.length; j++) {
              const c = deck[j];
              if (c !== card && c.type === "lixo") {
                toRemove.add(c);
                lixoRemovido++;
              }
            }

            if (lixoRemovido === 0) {
              log("Nenhuma carta de lixo na m√£o para reciclar.");
              div.classList.add("card-remove");
              setTimeout(() => {
                for (let k = deck.length - 1; k >= 0; k--) {
                  if (deck[k] === card) { deck.splice(k, 1); break; }
                }
                drawCards();
                updateHUD();
              }, 300);
              return;
            }

            const defesa = lixoRemovido * 5;
            playerShield += defesa;
            glowPlayer("blue");
            floatText(document.getElementById("player"), `+${defesa}`, "cyan");
            updateHUD();

            div.classList.add("card-remove");
            setTimeout(() => {
              for (let k = deck.length - 1; k >= 0; k--) {
                if (toRemove.has(deck[k])) deck.splice(k, 1);
              }
              drawCards();
              updateHUD();
            }, 300);

            return;
          } else if (card.name === "Xenofluxo Recicl√°vel") {
            const toRemove = new Set();
            toRemove.add(card);
            let lixoRemovido = 0;

            for (let j = 0; j < deck.length; j++) {
              const c = deck[j];
              if (c !== card && c.type === "lixo") {
                toRemove.add(c);
                lixoRemovido++;
              }
            }

            if (lixoRemovido === 0) {
              log("Nenhuma carta de lixo na m√£o para reciclar.");
              div.classList.add("card-remove");
              setTimeout(() => {
                for (let k = deck.length - 1; k >= 0; k--) {
                  if (deck[k] === card) { deck.splice(k, 1); break; }
                }
                drawCards();
                updateHUD();
              }, 300);
              return;
            }

            energy += lixoRemovido;
            glowPlayer("green");
            floatText(document.getElementById("player"), `+${lixoRemovido}`, "cyan");
            updateHUD();

            div.classList.add("card-remove");
            setTimeout(() => {
              for (let k = deck.length - 1; k >= 0; k--) {
                if (toRemove.has(deck[k])) deck.splice(k, 1);
              }
              drawCards();
              updateHUD();
            }, 300);

            return;
          } else if (card.name === "G√ÜPROTOCOL") {
            const power = card.basePower ?? card.power ?? 0;
            const toRemove = new Set();
            toRemove.add(card);
            // coleta somente as cartas da "m√£o" (o seu deck representa a m√£o aqui)
            const matches = [];
            for (let j = deck.length - 1; j >= 0; j--) {
              const c = deck[j];
              if (c !== card && (c.type === "lixo")) {
                matches.push(c);
                toRemove.add(c);
              }
            }
            if (matches.length === 0) {
              log("Nenhuma carta de lixo/gaea para reciclar.");
              div.classList.add("card-remove");
              setTimeout(() => {
                for (let k = deck.length - 1; k >= 0; k--) {
                  if (deck[k] === card) { deck.splice(k, 1); break; }
                }
                drawCards();
                updateHUD();
              }, 300);
              return;
            }

            // calcula efeitos agregados
            const totalRemoved = matches.length;
            const totalDamage = totalRemoved * power;
            const totalHeal = totalRemoved * power;
            const totalShield = totalRemoved * power;

            // aplica efeitos (um √∫nico efeito agregado)
            if (enemies.length > 0) {
              animateDamage(enemies[0].el);
              enemies[0].hp -= totalDamage;
              floatText(enemies[0].el, `-${totalDamage}`, "red");
            }
            glowPlayer("cintilante");
            playerShield += totalShield;
            playerHP = Math.min(playerHP + totalHeal, playerMaxHP);
            floatText(document.getElementById("player"), `+${totalShield}`, "cyan");
            floatText(document.getElementById("player"), `+${totalHeal}`, "green");

            // anima a carta usada
            div.classList.add("card-remove");

            // ap√≥s anima√ß√£o, remova **todos** os objetos marcados de uma vez (iterando de tr√°s p/ frente)
            setTimeout(() => {
              for (let k = deck.length - 1; k >= 0; k--) {
                if (toRemove.has(deck[k])) deck.splice(k, 1);
              }
              drawCards();
              checkEnemies();
              updateHUD();
            }, 300);

            return; // importante: evita que o handler continue e fa√ßa o splice(i,1) gen√©rico
          }

          div.classList.add("card-remove");
          setTimeout(() => {
            deck.splice(i, 1);
            drawCards();
            checkEnemies();
          }, 300);
          updateHUD();
          // caso a energia seja 0 ele skipa o turno auto
          // if (energy === 0) enemyTurn();
        };
        cards.appendChild(div);
      });
    }
    // buff em itens aumenta esse
    let maoInicio = 7;
    // buff em cards aumenta esse
    let limiteMao = 7;

    function drawNewCards() {
      deck.length = 0;
      const maxCopies = 1;

      while (deck.length < limiteMao) {
        const base = { ...allCards[Math.floor(Math.random() * allCards.length)] };

        // conta quantas vezes tal carta j√° foi adicionada
        const count = deck.filter(card => card.name === base.name).length;

        if (count < maxCopies) {
          deck.push({ ...base, power: base.basePower });
        }
      }
    }

    function takeDamage(dmg) {
      if (playerShield > 0) {
        const absorbed = Math.min(playerShield, dmg);
        playerShield -= absorbed;
        dmg -= absorbed;
      }

      if (dmg > 0) {
        playerHP -= dmg;
      }

      if (playerHP < 0) playerHP = 0;

      playerShield = 0;
      updateHUD();
    }

    function enemyTurn() {
      setTimeout(() => {
        enemies.forEach(e => {
          const actions = e.behavior();
          actions.forEach(act => {
            if (act.type === "attack") {
              let dano = act.value;

              if (playerShield > 0) {
                let absorbed = Math.min(dano, playerShield);
                playerShield -= absorbed;
                dano -= absorbed;
              }

              if (dano > 0) {
                playerHP -= dano;
              }

              animateDamage(document.getElementById("player"));
              floatText(document.getElementById("player"), `-${act.value}`, "orange");
              log(`${e.name} atacou!`);
            } else if (act.type === "attackVida") {
              playerHP -= act.value;
              animateDamage(document.getElementById("player"));
              floatText(document.getElementById("player"), `-${act.value}`, "orange");
              log(`${e.name} atacou!`);
            } else if (act.type === "heal") {
              // seleciona o inimigo "mais √† frente" (prefer√™ncia: enemies[0], se n√£o for ele)
              let target = null;
              if (enemies.length > 0) {
                if (enemies[0] !== e && enemies[0].hp > 0) {
                  target = enemies[0];
                } else {
                  // procura o primeiro vivo que n√£o seja o curandeiro
                  for (let t of enemies) {
                    if (t !== e && t.hp > 0) { target = t; break; }
                  }
                }
              }
              // se n√£o achar outro alvo, opcional: cura a si mesmo
              if (!target) {
                if (e.hp > 0) target = e;
              }
              if (target) {
                const max = target.maxHp ?? target.hp;
                const healed = act.value;
                target.hp = Math.min(target.hp + healed, max);
                floatText(target.el, `+${healed}`, "green");
                log(`${e.name} curou ${target.name} em ${healed} de HP!`);
                // opcional: breve efeito visual
                target.el.classList.add("healed");
                setTimeout(() => target.el.classList.remove("healed"), 600);
              }
            }
          });
        });

        energy = 3;
        playerShield = 0;
        drawNewCards();
        drawCards();
        updateHUD();
        checkGameOver();
      }, 600);
    }

    function checkEnemies() {
  for (let i = enemies.length - 1; i >= 0; i--) {
    if (enemies[i].hp <= 0) {
      log(`${enemies[i].name} foi derrotado!`);

      // anima inimigo
      if (enemies[i].el) {
        enemies[i].el.style.transition = "opacity 0.5s ease, transform 0.5s ease";
        enemies[i].el.style.opacity = "0";
        enemies[i].el.style.transform = "scale(0.8)";
      }

      // anima barra de vida
      if (enemies[i].barEl) {
        const barP = enemies[i].barEl.closest("p");
        if (barP) {
          barP.style.transition = "opacity 0.5s ease";
          barP.style.opacity = "0";
        }
      }

      // remove ap√≥s anima√ß√£o
      ((index) => {
        setTimeout(() => {
          if (enemies[index]) {
            if (enemies[index].el) enemies[index].el.remove();
            if (enemies[index].barEl) {
              const barP = enemies[index].barEl.closest("p");
              if (barP) barP.remove();
            }
            enemies.splice(index, 1);

            // se n√£o houver mais inimigos, abre popup
            if (enemies.length === 0 && playerHP > 0) {
              document.getElementById("overlay").style.display = "block";
              document.getElementById("popup").style.display = "block";
              gerarItens();
              limiteMao = maoInicio;
              document.getElementById("enemies").style.display = "none";
              document.getElementById("lifeBarsContainer").style.display = "none";
            }
          }
        }, 500);
      })(i); // captura o valor de i
    }
  }
}

    function gerarItens() {
      const container = document.getElementById("recompensa");

      // Limpa itens antigos
      container.innerHTML = "";

      for (let i = 1; i <= 3; i++) {
        // Cria um novo elemento
        const item = document.createElement("div");

        // Define conte√∫do do item
        item.textContent = "Item " + i;

        // Adiciona estilo opcional
        item.style.padding = "10px";
        item.style.margin = "5px";
        item.style.backgroundColor = "#444";
        item.style.borderRadius = "5px";

        // Adiciona o item dentro do container
        container.appendChild(item);
      }
    }

    function fecharPopup() {
      document.getElementById("overlay").style.display = "none";
      document.getElementById("popup").style.display = "none";
    }

    function checkGameOver() {
      if (playerHP <= 0) {
        log("Voc√™ perdeu!");
        document.getElementById("cards").innerHTML = "";
      }
    }

    function log(txt) {
      const el = document.createElement("div");
      el.textContent = txt;
      document.getElementById("log").prepend(el);
    }

    spawnEnemies(); // gera inimigos aleat√≥rios no in√≠cio
    drawNewCards();
    drawCards();
    updateHUD();
  </script>
</body>

</html>